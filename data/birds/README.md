# Modifying dataset by adding extra object

### Pre-requisite files
- ####  A detected logs in json file or a bounding boxes along with a list of image names in txt files 
  - **Detected logs** <br/>
  A json file that record an array of the path and the size of the images with the free spaces left within the images.
  ```
  detected_log.json
  [{
    "path": the image path,
    "image_w": the image width,
    "image_h": the image height,
    "left": the width of the free space on the left of the focal object,
    "top": the height of the free space on the top of the focal object,
    "right": the width of the free space on the right of the focal object,
    "bottom": the height of the free space on the bottom of the focal object,
  }]
  ```
  **Note: This file is generated by using an object detection machine called [YOLOv3](https://github.com/experiencor/keras-yolo3) [1]
  
  - **Bounding boxes and image names list**<br/>
  Two txt file that record a list of bounding boxes and a list of image names in each files.
  ```
  bounding_boxes.txt
  [image no.] [x_min] [y_min] [x_max] [y_max]
  
  images.txt
  [image no.] [image name]
  ```
  **Note: These files can be provided from the datasets of a collection of birds called [Caltech-UCSD Birds-200-2011](http://www.vision.caltech.edu/visipedia/CUB-200-2011.html)

### Example

**All examples are modifying the [Caltech-UCSD Birds-200-2011](http://www.vision.caltech.edu/visipedia/CUB-200-2011.html) dataset

#### Modifying image by adding object outside detected box
- Run the command below
```
python addExtraBirdByRegions.py CUB_200_2011/images -d detected_logs.json 
```
- modified images can be found in a folder called "output"

#### Modifying image by adding object inside detected box
- Run the command below
```
python addExtraBirdByRegions.py CUB_200_2011/images -d detected_logs.json -P 1
```
- modified images can be found in a folder called "output"

#### Modifying image by adding object outside bounding box
- Run the command below
```
python addExtraBirdByRegions.py CUB_200_2011/images -b CUB_200_2011/bounding_boxes.txt -i CUB_200_2011/images.txt 
```
- modified images can be found in a folder called "output"

#### Modifying image by adding object inside bounding box
- Run the command below
```
python addExtraBirdByRegions.py CUB_200_2011/images -b CUB_200_2011/bounding_boxes.txt -i CUB_200_2011/images.txt -P 1 
```
- modified images can be found in a folder called "output"


### Other options
- `-e` set the folder of additional object <br/>
  eg. -e extra_birds
  
- `-d` set the path of the detected log file (***Should be a json file***) <br/>
  eg. -d detected_log.json

- `-b` set the path of the list of bounding boxes (***Should be a txt file and also set the path of image names list***) <br/>
  eg. -b CUB_200_2011/bounding_boxes.txt

- `-i` set the path of the list of image names (***Should be a txt file and also set the path of bounding boxes list***) <br/>
  eg. -b CUB_200_2011/images.txt

- `-r` set the region number
  eg. -r 2

- `-R` record the position of the added object into a txt file
  eg. -R savedRecord.txt

- `-o` set the path of output directory
  eg. -o output/modified_datasets
 
- `-s` set the size of the adding object (w x h)
  eg. -s 100 100 

- `-p` set the percentage of modifing images (***1 represent 100%***)
  eg. -p 0.25

- `-P` set the percentage of overlapping images (***1 represent 100%***)
  eg. -P 0.5
  


 ### Reference
 <a id="ref01">[1]</a> keras-yolo3: Training and Detecting Objects with YOLO3 [Code](https://github.com/experiencor/keras-yolo3)<br/>
